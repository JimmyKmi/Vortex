# VORT√ãX Deployment Guide

English | [ÁÆÄ‰Ωì‰∏≠Êñá](DEPLOYMENT.md)

> üìù This documentation is generated by LLM. If you find any issues, please submit an [Issue](https://github.com/JimmyKmi/vortex/issues)

This document provides detailed deployment instructions for the VORT√ãX file transfer system, including Docker containerization deployment and environment configuration.

## Docker Deployment (Recommended)

### Prerequisites

- Docker 19.03+
- Docker Compose v2+
- At least 1GB available memory
- At least 10GB available disk space (depends on expected file storage size)

### Basic Deployment Steps

1. **Create deployment directory**:

   ```bash
   mkdir vortex && cd vortex
   ```

2. **Create docker-compose.yml**:

   ```yaml
   version: '3.8'

   services:
     vortex:
       image: jimmykmi/vortex:latest
       env_file: ./.env
       container_name: vortex
       ports:
         - '21330:3000'
       volumes:
         - ./data:/app/data
       restart: unless-stopped
   ```

3. **Prepare environment configuration**:

   ```bash
   curl -o .env https://raw.githubusercontent.com/JimmyKmi/vortex/main/.env.example
   # Edit .env file to configure necessary parameters
   ```

4. **Start service**:

   ```bash
   docker-compose up -d
   ```

5. **Verify deployment**:
   - Access `http://YOUR_SERVER_IP:21330`
   - Check logs for anomalies: `docker-compose logs -f`

### Docker Tags

VORT√ãX provides the following Docker image tags:

- `latest`: Latest stable version, recommended for production
- `dogfood`: Latest testing version with experimental features
- `x.y.z`: Specific version number for fixed version deployment

### Data Persistence

VORT√ãX stores data in the `/app/data` directory inside the container. For data persistence, this directory is mapped to the host's `./data` directory via volume. This data directory contains:

- SQLite database file
- Uploaded files (if not using external storage like S3)
- System logs

Regular backup of this directory is recommended.

## Environment Variables

### Basic Configuration

| Variable Name     | Description      | Default Value | Required |
| ----------------- | ---------------- | ------------- | -------- |
| `APP_NAME`        | Application name | VORT√ãX        | No       |
| `APP_FOOTER`      | Footer text      | -             | No       |
| `APP_FOOTER_LINK` | Footer link      | -             | No       |

### Authentication Configuration

| Variable Name            | Description                   | Default Value | Required |
| ------------------------ | ----------------------------- | ------------- | -------- |
| `AUTH_SECRET`            | Authentication encryption key | -             | Yes      |
| `AUTH_TRUST_HOST`        | Trust proxy headers           | false         | No       |
| `AUTH_ZITADEL_CLIENT_ID` | Zitadel client ID             | -             | No       |
| `AUTH_ZITADEL_ISSUER`    | Zitadel issuer URL            | -             | No       |

### Storage Configuration

| Variable Name          | Description          | Default Value | Required        |
| ---------------------- | -------------------- | ------------- | --------------- |
| `S3_REGION`            | S3 region            | -             | Required for S3 |
| `S3_BUCKET_NAME`       | S3 bucket name       | -             | Required for S3 |
| `S3_ACCESS_KEY_ID`     | S3 access key ID     | -             | Required for S3 |
| `S3_SECRET_ACCESS_KEY` | S3 secret access key | -             | Required for S3 |
| `S3_ENDPOINT`          | S3 endpoint URL      | -             | Required for S3 |
| `S3_BASE_PATH`         | S3 base path         | -             | No              |

## Reverse Proxy Configuration

### Nginx Configuration Example

```nginx
server {
    listen 80;
    server_name vortex.yourdomain.com;

    # Redirect HTTP to HTTPS
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name vortex.yourdomain.com;

    # SSL configuration
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    # Optimized SSL settings
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;
    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;
    ssl_session_cache shared:SSL:10m;

    # Proxy settings
    location / {
        proxy_pass http://localhost:21330;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # Upload file size limit
        client_max_body_size 5000M;
    }
}
```
